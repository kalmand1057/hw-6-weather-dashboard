<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!--Bootstrap-->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">

    <!--JS-->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha384-B4gt1jrGC7Jh4AgTPSdUtOBvfO8shuf57BaghqFfPlYxofvL8/KUEfYiJOMMV+rV" crossorigin="anonymous"></script>

    <!--Google Fonts-->
    <link href="https://fonts.googleapis.com/css2?family=DM+Serif+Display&display=swap" rel="stylesheet">

    <!--CSS Stylesheet-->
    <link rel="stylesheet" href="style.css">

    <title>Weather Dashboard</title>
</head>


<body>
    <!--Header-->
    <header class="title"><h1>Weather Dashboard</h1></header>
    <!--Aside-->
    <div class="container">
        <div class="row">
            <!--Can click on city in search history-->
            <!--When clicked, can AGAIN pull up Today's Forecast and 5 Day Forecast from search history-->
            <!--Have search history persist. Make sure that when you close out, once you pull it back up the search history stays-->
            <div class="col-3" id="search">
                <h3>Search for a City</h3>
                <form id="city-form">
                    <label for="city-input"></label>
                    <input type="text" id="city-input"><br>
                    <!-- Button trigger -->
                    <input id="add-city" type="submit" value="Search">
                </form>
            </div>
            <!--main-->
            <main class="col-9" id="weather">
                <div class="row" id="today">
                    <div class="col">
                        <div class="city"></div>
                        <div class="temp"></div>
                        <div class="humidity"></div>
                        <div class="wind"></div>
                        <div class="index"></div>
                    </div>
                </div>
                <div class="row" id="forecast">
                    <div class="col">
                        <div class="row"><h3>5 Day Forecast</h3></div>
                        <div class="row">
                            <!--each card will have Date, Icon representation, Temperature, Humidity-->
                            <div class="col border border-dark" id="0">col</div>
                            <div class="col border border-dark" id="1">col</div>
                            <div class="col border border-dark" id="2">col</div>
                            <div class="col border border-dark" id="3">col</div>
                            <div class="col border border-dark" id="4">col</div>
                    </div>
                    </div>
                </div>
            </main>
        </div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script type="text/javascript">
    //1. Search for a city
        //Use Activity 9!
        var APIKey = "166a433c57516f51dfab1f7edaed8413";

        var city = "";
        var lat = "";
        var lon = "";
        var uvDataResponse = "";
       

        // Function for dumping the JSON content for each button into the div
        function displayCityInfo() {
            //var city = $(this).attr("data-name");
            var citySearchURL = "https://api.openweathermap.org/data/2.5/weather?q=" + city + "&appid=" + APIKey;

            $.ajax({
                url: citySearchURL,
                method: "GET"
            }).then(function(response) {
                var latLonSearchURL = "https://api.openweathermap.org/data/2.5/onecall?lat=" + response.coord.lat + "&lon=" + response.coord.lon + "&%20exclude=hourly,daily&appid=" + APIKey;
                $.ajax({
                    url: latLonSearchURL,
                    method: "GET"
                }).then(function(responseUvi) {
                    uvDataResponse = responseUvi;
                    // Temperature IN FARENHEIT
                    var tempF = (uvDataResponse.current.temp - 273.15) * 1.80 + 32;
           
                    //Transfering content to HTMl
                    $(".city").html("<h3>" + uvDataResponse.timezone + " (Also need date and icon)");
                    $(".temp").text("Temperature(F): " + tempF);
                    $(".humidity").text("Humidity: " + uvDataResponse.current.humidity + "%");
                    $(".wind").text("Wind Speed: " + uvDataResponse.current.wind_speed + " MPH");
                    $(".index").text("UV Index: " + uvDataResponse.current.uvi);
                });
            });

            var forecastURL = "";
            $.ajax({
                url: forecastURL,
                method: "GET"
            }).then(function(responseForecast) {
                //iterate list.count
                //create for loop by adding 
            });

        }

        // Function for displaying movie data
        function renderButtons() {
            // Deleting the buttons prior to adding new movies
            // (this is necessary otherwise you will have repeat buttons)
            $("#buttons-view").empty();

            // Looping through the array of movies
            for (var i = 0; i < movies.length; i++) {

                // Then dynamically generating buttons for each movie in the array
                // This code $("<button>") is all jQuery needs to create the beginning and end tag. (<button></button>)
                var a = $("<button>");
                // Adding a class of movie to our button
                a.addClass("movie");
                // Adding a data-attribute
                a.attr("data-name", movies[i]);
                // Providing the initial button text
                a.text(movies[i]);
                // Adding the button to the buttons-view div
                $("#buttons-view").append(a);
            }
        }

        // This function handles events where one button is clicked
        $("#add-city").on("click", function(event) {
            event.preventDefault();

            // This line grabs the input from the textbox
            city = $("#city-input").val().trim();

            // Adding the movie from the textbox to our array
               // movies.push(movie);
               // console.log(movies);

            // Calling renderButtons which handles the processing of our movie array
                    //renderButtons();
        });

        // Function for displaying the movie info
        // Using $(document).on instead of $(".movie").on to add event listeners to dynamically generated elements
        $(document).on("click", "#add-city", displayCityInfo);

    //2.Today's Forecast

        //need a var for today's date in city div
        
        //need icon as well for city div

        //run AJAX to call OpenWeatherMap API
    //     $.ajax({
    //         url: queryURL,
    //         method: "GET"
    //     }).then(function(response) {
    //        console.log(queryURL);
    //        console.log(response);

    //        //Temperature IN FARENHEIT
    //        var tempF = (response.current.temp - 273.15) * 1.80 + 32;
           
    //        //Transfering content to HTMl
    //        $(".city").html("<h3>" + response.timezone + " (Also need date and icon)");
    //        $(".temp").text("Temperature(F): " + tempF);
    //        $(".humidity").text("Humidity: " + response.current.humidity + "%");
    //        $(".wind").text("Wind Speed: " + response.current.wind_speed + " MPH");
    //        $(".index").text("UV Index: " + response.current.wind_speed);

    //        //Logging the data in the console as well
    //        console.log("Temperature (F):" + tempF);
    //        console.log("Humidity: " + response.current.humidity);
    //        console.log("Wind Speed: " + response.current.wind_speed);
    //        console.log("UV Index: " + uvDataResponse);

    //        //UV Index number is in a color that indicates whether it is favorable, moderate or severe
    //    })

    //3. Five Day Forecast
</script>
</body>
</html>